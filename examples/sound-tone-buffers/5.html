<body style="background: white"></body>
<script src="https://unpkg.com/tone"></script>
<script src="https://cdn.jsdelivr.net/gh/netizenorg/netnet-standard-library/build/nn.min.js"></script>
<script src="https://algorithmicmusic.online/js/viz-helpers.js"></script>
<script>
/* global Tone, nn, createWaveform */

function createCustomBuffer (seconds, channels) {
  const sr = Tone.context.sampleRate
  const bufferSize = seconds * sr
  const buffer = Tone.context.createBuffer(channels, bufferSize, sr)
  // create variables for generating a sine wave
  const freq = 440
  const amp = 0.25
  const scalar = (freq * 2 * Math.PI) / sr
  // loop through each channel and fill it with a sine wave
  for (let ch = 0; ch < channels; ch++) {
    const samples = buffer.getChannelData(ch)
    for (let s = 0; s < bufferSize; s++) {
      samples[s] = Math.sin(s * scalar) * amp
    }
  }
  return buffer
}

// function for creating and playing the noise buffer
function playTone () {
  const buffer = createCustomBuffer(1, 2)
  const sound = new Tone.BufferSource(buffer).toDestination()
  sound.connect(wave)
  sound.start()
}

// create GUI
nn.create('button')
  .content('play tone')
  .addTo('body')
  .on('click', playTone)

const wave = viz.createWaveform()

</script>
